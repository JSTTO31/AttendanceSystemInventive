import{_ as W,J,A as _,B as x,n as C,U as P,x as M,a2 as S,C as n,c as t,E as w,d as y,G as k,D as o,V as f,l as z,r as $,w as E,F as p,M as F,N,I as L,v as O,a8 as R}from"./index-df5c3e00.js";import{C as U,c as H,L as Y,P as q,e as G,p as K,a as Q,b as X,f as Z}from"./index-7f0f88cc.js";import{A as ee,h as te,i as b,g as j,l as ae,V as ne}from"./VCard-5d4c2059.js";import{a as V,V as A}from"./VRow-7f525726.js";import{V as le}from"./VDivider-5da1d1a6.js";import{V as se}from"./VChip-501e8c85.js";import{V as oe}from"./VMenu-6c39483f.js";import{_ as re}from"./ManualAttendanceDialog.vue_vue_type_script_setup_true_lang-94c8d59f.js";import{V as B}from"./VSpacer-f30f2091.js";import{V as I}from"./VBtn-041272dd.js";import{V as ie}from"./VTable-5e3fcc5e.js";import{V as ue}from"./VPagination-b9d318a5.js";import{V as ce}from"./VContainer-4bb91f49.js";import"./tag-c06c36d9.js";/* empty css              */import"./index-3b25c727.js";import"./VOverlay-4618fd3d.js";import"./forwardRefs-3d48cfa0.js";import"./delay-dcf0f73e.js";import"./course-a0571579.js";import"./main-c41744b1.js";import"./VDialog-554ec4da.js";import"./VRadio-63de04df.js";import"./VSelectionControl-3c9d191f.js";import"./VProgressCircular-79f71f1d.js";const de="/assets/data-quality-f053b913.png";U.register(H,Y,q,G,K,Q,X);const me={components:{LineChart:Z},props:{data:{type:{},default:()=>({labels:["Day 1","Day 2","Day3","Day4","Day5","Day6","Day7"],datasets:[{backgroundColor:"#2196F3",borderJoinStyle:"round",borderColor:"#2196F3",tension:.5,data:[40,39,10,40,39,80,40]}]})},options:{type:Object,default:()=>({responsive:!0,maintainAspectRatio:!1,scales:{y:{display:!1},x:{grid:{display:!1}}},plugins:{legend:{display:!1}}})}}};function pe(d,a,v,e,m,i){const c=J("LineChart",!0);return _(),x(c,{data:v.data,options:v.options,style:{height:"100%"}},null,8,["data","options"])}const _e=W(me,[["render",pe]]),fe=C({__name:"StudentLineChart",props:["month"],setup(d){const a=d,{current:v}=P(),{student:e}=M(S()),m=()=>{let i=e.value.attendances.slice().filter(r=>new Date(r.created_at).getMonth()==a.month).sort((r,l)=>new Date(r.created_at)-new Date(l.created_at)),c=[],h=[i[0]];return i.slice(1).forEach(r=>{let l=new Date(r.created_at),s=new Date(h[0].created_at),D=new Date(h[0].created_at),u=new Date(h[0].created_at),g=D.getDate()-s.getDay();D.setDate(g),u.setDate(g+6),l.setHours(0,0,0,0),D<=l&&u>=l?h.push(r):(c.push(h),h=[r])}),h.length>0&&c.push(h),{labels:c.map((r,l)=>"Week "+(l+1)),datasets:[{backgroundColor:v.value.colors.primary,borderJoinStyle:"round",borderColor:v.value.colors.primary,tension:.1,data:c.map(r=>r.reduce((l,s)=>l+=(s==null?void 0:s.work_time)||0,0))}]}};return(i,c)=>(_(),x(b,{class:"h-100 border pa-md-4 pa-0",flat:""},{default:n(()=>[t(ee,null,{default:n(()=>[w(" Weekly work time ")]),_:1}),t(te,{class:"pa-0"},{default:n(()=>[t(_e,{style:{height:"350px"},data:m(),class:"pa-5"},null,8,["data"])]),_:1})]),_:1}))}}),ve=C({__name:"AttendanceListItem",props:{attendance:{}},setup(d){const a=d;M(S());const v=y(()=>a.attendance&&a.attendance.time_in?new Date(a.attendance.time_in).toLocaleTimeString():"--"),e=y(()=>a.attendance&&a.attendance.time_out?new Date(a.attendance.time_out).toLocaleTimeString():"--"),m=y(()=>a.attendance&&a.attendance.time_in&&a.attendance.time_out?parseInt(a.attendance.work_time).toFixed(0)+"h":"--");return(i,c)=>(_(),k("tr",null,[o("td",null,f(new Date(i.attendance.created_at).toDateString()),1),o("td",null,f(v.value),1),o("td",null,f(e.value),1),o("td",null,f(m.value),1)]))}}),he={class:"d-flex"},ge={class:"font-weight-medium"},ye={class:"font-weight-medium"},we={class:"font-weight-medium"},De={class:"d-flex text-subtitle-2 align-center justify-sm-space-between"},xe={inheritAttrs:!0},be=C({...xe,__name:"CalendarBoxDay",props:{day:{},month:{}},setup(d){const a=d,{student:v}=M(S()),e=y(()=>v.value.attendances.find(s=>new Date(s.created_at).getDate()==a.day&&new Date(s.created_at).getMonth()==a.month)),m=y(()=>e.value?new Date(e.value.created_at).toDateString():"-- -- --"),i=y(()=>e.value?e.value.is_absent?{variant:"elevated",color:"error"}:e.value.policy&&e.value.time_out?{variant:"elevated",color:"warning"}:e.value.is_event?{variant:"elevated",color:"green"}:!e.value.time_in||!e.value.time_out&&!e.value.is_event?{variant:"outlined",color:"primary"}:{variant:"elevated",color:"primary"}:{variant:"outlined",color:"primary"}),c=y(()=>e.value&&e.value.time_in?new Date(e.value.time_in).toLocaleTimeString():"--"),h=y(()=>e.value&&e.value.time_out?new Date(e.value.time_out).toLocaleTimeString():"--"),r=y(()=>e.value&&e.value.time_in&&e.value.time_out?parseInt(e.value.work_time).toFixed(0)+"h":"--"),l=y(()=>{var s,D,u,g;return(s=e.value)!=null&&s.is_absent?"absent":(D=e.value)!=null&&D.policy?"late":(u=e.value)!=null&&u.time_in&&e.value.time_out?"present":(g=e.value)!=null&&g.is_event?"event":"pending"});return(s,D)=>(_(),x(oe,{"open-on-hover":"","open-delay":"500"},{activator:n(({props:u})=>[t(b,z({...u,...s.$attrs},{flat:"",color:i.value.color,variant:i.value.variant,class:"mr-2 d-flex align-center justify-center",height:"40",style:{"user-select":"none"},width:"40"}),{default:n(()=>[w(f(s.day),1)]),_:2},1040,["color","variant"])]),default:n(()=>[t(b,{width:"380",class:"pa-3 rounded-lg",style:{"user-select":"none"}},{default:n(()=>[o("div",null,[o("div",he,[t(V,{class:"d-flex align-center justify-end font-weight-regular flex-column flex-column-reverse"},{default:n(()=>[w(" Time in "),o("span",ge,f(c.value),1)]),_:1}),t(V,{class:"d-flex align-center justify-end font-weight-regular flex-column flex-column-reverse"},{default:n(()=>[w("Time out "),o("span",ye,f(h.value),1)]),_:1}),t(V,{class:"d-flex align-center justify-end font-weight-regular flex-column flex-column-reverse"},{default:n(()=>[w("Work time "),o("span",we,f(r.value),1)]),_:1})])]),t(le,{class:"my-1"}),o("div",De,[o("span",null,[t(j,{size:"23"},{default:n(()=>[w("mdi-clock-outline")]),_:1}),w(" "+f(m.value),1)]),t(se,{color:l.value=="absent"?"error":l.value=="present"?"primary":l.value=="late"?"warning":l.value=="event"?"green":"grey",class:"text-capitalize",size:"small"},{default:n(()=>[w(f(l.value),1)]),_:1},8,["color"])])]),_:1})]),_:1}))}}),Ve={class:"d-flex align-center w-100"},ke=C({__name:"Calendar",props:["selectedMonth"],emits:["update:selectedMonth"],setup(d,{emit:a}){const v=d,e=$(!1),{student:m}=M(S()),i=$(),c=["January","February","March","April","May","June","July","August","September","October","November","December"],r=new Date().getFullYear(),l=y(()=>new Date(r,v.selectedMonth+1,0).getDate()),s=D=>{const u=new Date;u.setDate(D),u.setMonth(v.selectedMonth),i.value=u};return E(()=>i.value,()=>{e.value=!0}),(D,u)=>p(m).attendances?(_(),x(b,{key:0,class:"pa-3 border h-100",flat:""},{default:n(()=>[t(b,{class:"d-flex pl-1 mt-1 align-start flex-wrap h-100 mb-5",flat:""},{default:n(()=>[o("div",Ve,[o("h3",null,[t(j,{class:"mr-3"},{default:n(()=>[w("mdi-calendar")]),_:1}),w(f(c[d.selectedMonth])+" "+f(p(r)),1)]),t(B),t(I,{icon:"mdi-chevron-left",class:"rounded-lg mr-2",flat:"",onClick:u[0]||(u[0]=g=>a("update:selectedMonth",d.selectedMonth-1)),disabled:d.selectedMonth<1,variant:"text"},null,8,["disabled"]),t(I,{icon:"mdi-chevron-right",class:"rounded-lg",flat:"",onClick:u[1]||(u[1]=g=>a("update:selectedMonth",d.selectedMonth+1)),disabled:d.selectedMonth>10,variant:"text"},null,8,["disabled"])]),(_(!0),k(N,null,F(l.value,g=>(_(),x(be,{status:"absent",key:g,day:g,month:d.selectedMonth,onClick:Le=>s(g)},null,8,["day","month","onClick"]))),128)),(_(),x(re,{start_at:i.value,key:i.value,"show-dialog":e.value,"onUpdate:showDialog":u[2]||(u[2]=g=>e.value=g)},null,8,["start_at","show-dialog"]))]),_:1})]),_:1})):L("",!0)}}),Ce=o("h2",{class:"ml-2"},"No chart",-1),Me={key:0},Se=o("h3",{class:"mb-2"},"Attendance History",-1),$e=o("thead",null,[o("tr",null,[o("th",null,"Date"),o("th",null,"Time in"),o("th",null,"Time out"),o("th",null,"Work time")])],-1),Te={key:1,class:"w-100 align-center mt-5 d-flex"},T=9,nt=C({__name:"Index",setup(d){const{mobile:a}=O(),e=$(new Date().getMonth()),{student:m}=M(S()),i=$(1);let c=y(()=>{var r;return Math.ceil((((r=m.value.attendances)==null?void 0:r.length)||0)/T)});const h=y(()=>m.value.attendances.slice().sort((r,l)=>new Date(l.created_at)-new Date(r.created_at)));return(r,l)=>(_(),x(ce,{class:"px-0",fluid:""},{default:n(()=>[t(A,{"align-content":"stretch"},{default:n(()=>[t(V,{cols:p(a)?12:8},{default:n(()=>[p(m).attendances&&p(m).attendances.length>0?(_(),x(fe,{key:0,style:{height:"50px"},month:e.value},null,8,["month"])):(_(),x(b,{key:1,class:"pa-5 d-flex align-center justify-center rounded-lg border",flat:"",height:"450"},{default:n(()=>[t(ae,{class:"mr-4",size:"60"},{default:n(()=>[t(ne,{src:de})]),_:1}),Ce]),_:1}))]),_:1},8,["cols"]),t(V,{cols:p(a)?12:4},{default:n(()=>[t(ke,{"selected-month":e.value,"onUpdate:selectedMonth":l[0]||(l[0]=s=>e.value=s)},null,8,["selected-month"])]),_:1},8,["cols"])]),_:1}),t(A,null,{default:n(()=>[t(V,null,{default:n(()=>[p(m).attendances&&p(m).attendances.length>0?(_(),k("div",Me,[Se,t(b,{width:p(a)?366:"auto",style:R(p(a)?"overflow-x: scroll;":"")},{default:n(()=>[t(b,{flat:"",width:p(a)?550:"auto"},{default:n(()=>[t(ie,{hover:""},{default:n(()=>[$e,o("tbody",null,[(_(!0),k(N,null,F(h.value.slice((i.value-1)*T,i.value*T),s=>(_(),x(ve,{key:s.id,attendance:s},null,8,["attendance"]))),128))])]),_:1})]),_:1},8,["width"])]),_:1},8,["width","style"])])):L("",!0),p(c)>1?(_(),k("div",Te,[w(" Page "+f(i.value)+" / "+f(p(c))+" ",1),t(B),t(ue,{length:p(c),color:"primary","total-visible":p(a)?1:5,modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=s=>i.value=s)},null,8,["length","total-visible","modelValue"])])):L("",!0)]),_:1})]),_:1})]),_:1}))}});export{nt as default};
