import{d as C,e as V,V as P}from"./VCard-81742aa1.js";import{V as b}from"./VSpacer-58a18ea2.js";import{V as c}from"./VBtn-5eaa95be.js";import{V as x}from"./VDialog-d2e18591.js";import{d as _,o as k,p as D,w as i,a as n,e as m,b as y,h as S,a8 as v,r as f,s as p,a6 as h}from"./index-1b2f18c0.js";import{u as A}from"./useStudent-b532c908.js";const $=y("h3",{class:"mb-2"},"Do you want to apply the policy?",-1),z=y("h4",{class:"font-weight-regular"}," Its seems the student comes late. Do you want apply the policy on this student? ",-1),j=_({__name:"ShowPolicyDialog",props:["showPolicyConfirmation","student","isLoading"],emits:["update:showPolicyConfirmation","allow","deny"],setup(o,{emit:l}){return(r,e)=>(k(),D(x,{"model-value":o.showPolicyConfirmation,"onClick:outside":e[3]||(e[3]=t=>l("update:showPolicyConfirmation",!1)),width:"450"},{default:i(()=>[n(P,{loading:o.isLoading,disabled:o.isLoading,class:"rounded-lg"},{default:i(()=>[n(C,{class:"pa-5"},{default:i(()=>[$,z]),_:1}),n(V,{class:"bg-grey-lighten-4"},{default:i(()=>[n(b),n(c,{variant:"elevated",class:"text-capitalize",size:"small",color:"warning",onClick:e[0]||(e[0]=t=>l("allow"))},{default:i(()=>[m("Yes, Apply it")]),_:1}),n(c,{variant:"elevated",class:"text-capitalize",onClick:e[1]||(e[1]=t=>l("deny")),size:"small"},{default:i(()=>[m("No, Don't apply it")]),_:1})]),_:1}),n(c,{icon:"mdi-close",variant:"text",class:"ma-1",size:"small",onClick:e[2]||(e[2]=t=>l("update:showPolicyConfirmation",!1)),style:{position:"absolute",top:"0",right:"0"}})]),_:1},8,["loading","disabled"])]),_:1},8,["model-value"]))}}),E=o=>{const l=S(),r=v(),e=f(!1),t=f(!1);return{enter:()=>{const a=new Date,s=new Date;if(s.setHours(9),s.setMinutes(15),a>s&&!t.value){t.value=!0;return}e.value=!0,r.enter(o.id).then(()=>{e.value=!1,t.value=!1})},leave:(a,s)=>{e.value=!0,r.leave(a,s).then(()=>{e.value=!1;const{students:w}=p(h()),u=w.value.find(d=>d.id==a);if(u){const d=f(u),{work_time_total:g}=A(d);g.value.hours>=parseInt(u.remaining)&&l.push({query:{type:"completed",name:u.first_name+" "+u.last_name}})}})},absent:()=>{e.value=!0,r.absent(o.id).then(()=>{e.value=!1})},enterWithPolicy:()=>{e.value=!0,r.enterWithPolicy(o.id).then(()=>{e.value=!1,t.value=!1})},showPolicyConfirmation:t,isLoading:e,removeAttendance:()=>{const{student:a}=p(h()),s=v();a.value.attendance&&(e.value=!0,s.remove(a.value.id,a.value.attendance.id).then(()=>e.value=!1))}}};export{j as _,E as u};
